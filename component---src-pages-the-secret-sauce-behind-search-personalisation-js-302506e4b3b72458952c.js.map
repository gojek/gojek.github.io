{"version":3,"sources":["webpack:///component---src-pages-the-secret-sauce-behind-search-personalisation-js-302506e4b3b72458952c.js","webpack:///./src/pages/the-secret-sauce-behind-search-personalisation.js"],"names":["webpackJsonp","384","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_react","_react2","_seo","_seo2","GojekBlog","_Component","this","apply","arguments","render","createElement","className","isDynamic","title","description","url","src","width","class","alt","target","href","Component"],"mappings":"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","file":"component---src-pages-the-secret-sauce-behind-search-personalisation-js-302506e4b3b72458952c.js","sourcesContent":["webpackJsonp([36088380180016],{\n\n/***/ 384:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\texports.__esModule = true;\n\t\n\tvar _react = __webpack_require__(1);\n\t\n\tvar _react2 = _interopRequireDefault(_react);\n\t\n\tvar _reactHelmet = __webpack_require__(11);\n\t\n\tvar _seo = __webpack_require__(9);\n\t\n\tvar _seo2 = _interopRequireDefault(_seo);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar GojekBlog = function (_Component) {\n\t  _inherits(GojekBlog, _Component);\n\t\n\t  function GojekBlog() {\n\t    _classCallCheck(this, GojekBlog);\n\t\n\t    return _possibleConstructorReturn(this, _Component.apply(this, arguments));\n\t  }\n\t\n\t  GojekBlog.prototype.render = function render() {\n\t    return _react2.default.createElement(\n\t      \"section\",\n\t      { className: \"first-section pt-3\" },\n\t      _react2.default.createElement(_seo2.default, {\n\t        isDynamic: false,\n\t        title: \" Gojek : The Secret Sauce Behind Search Personalisation \",\n\t        description: \"How Gojek uses machine learning to personalise search results in GoFood.\",\n\t        url: \"https://gojek.io/the-secret-sauce-behind-search-personalisation\"\n\t      }),\n\t      _react2.default.createElement(\n\t        \"div\",\n\t        { className: \"container\" },\n\t        _react2.default.createElement(\n\t          \"div\",\n\t          { className: \"row\" },\n\t          _react2.default.createElement(\n\t            \"div\",\n\t            { className: \"mb-3\" },\n\t            _react2.default.createElement(\n\t              \"h2\",\n\t              { className: \"mb-0 posting-headline mt-2 heading maison-bold font-lg text-black \" },\n\t              \"The Secret Sauce Behind Search Personalisation\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"div\",\n\t              { className: \"text-success blog-date roboto-bold\" },\n\t              _react2.default.createElement(\n\t                \"p\",\n\t                null,\n\t                \"Written by - Jewel James\"\n\t              )\n\t            )\n\t          ),\n\t          _react2.default.createElement(\n\t            \"div\",\n\t            { className: \"px-4 px-md-0 font-xs-l roboto-regular\" },\n\t            _react2.default.createElement(\"img\", {\n\t              className: \"img-fluid img-responsive\",\n\t              src: \"../images/blog/search-personalisation-banner.jpeg\",\n\t              width: \"100%\"\n\t            }),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              { className: \"pt-4\" },\n\t              \"Are you looking for food? Thinking about burgers and crispy chicken fritters with creamy sauces sitting on a warm, soft bun? At least, that\\u2019s what I am thinking about. May be you\\u2019re different. Vegan perhaps? Or craving noodles? Each of us turn into a different person when we are hungry, and this is the story about how GoFood \\u2014 Gojek\\u2019s food delivery service \\u2014 helps you find the bite you crave.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"blockquote\",\n\t              { \"class\": \"blockquote custom-blockquote my-4\" },\n\t              _react2.default.createElement(\n\t                \"em\",\n\t                { \"class\": \"mb-0 lead font-lg ml-3\" },\n\t                \"At the core of the food ordering experience, sits search.\"\n\t              )\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"Searches are part of so many of our interactions on web and mobile, that we don\\u2019t even notice it anymore. This is mostly because modern search engines have matured to a point where they can deliver high quality results even if the entered query is a weak signal of the user\\u2019s intent. Even when weak, every query still contains a piece of the user\\u2019s intent.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"In the case of GoFood, that piece is a fragment of our user\\u2019s hunger-driven brain.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"In this post, we\\u2019ll discuss how we personalise the search results we surface on GoFood, based on the information we have about our users\\u2019 food preferences.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"h5\",\n\t              { className: \"text-center text-md-left text-black mt-5 maison-bold font-lg\" },\n\t              \"How Each of Us Differ\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              { className: \"mt-3 mb-5\" },\n\t              \"Let\\u2019s look at two of our GoFood users who have started feeling the pangs of hunger, and come online to check restaurants near them. Let\\u2019s look at two of our GoFood users who have started feeling the pangs of hunger, and come online to check restaurants near them.\"\n\t            ),\n\t            _react2.default.createElement(\"img\", {\n\t              src: \"../images/blog/comparision.jpeg\",\n\t              alt: \"How each of us differ\",\n\t              className: \"img-fluid img-responsive\"\n\t            }),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              { className: \"pt-4\" },\n\t              \"They both open our app and click on the\",\n\t              \" \",\n\t              _react2.default.createElement(\n\t                \"kbd\",\n\t                { className: \"custom-code-block\" },\n\t                \"NEAR ME\"\n\t              ),\n\t              \" tile that lets users find the restaurants near them. We show them the nearest restaurants first, and this is what they both see.\"\n\t            ),\n\t            _react2.default.createElement(\"img\", {\n\t              src: \"../images/blog/near-me.jpeg\",\n\t              alt: \"Nearest restaurants\",\n\t              className: \"img-fluid img-responsive\"\n\t            }),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              { className: \"pt-3 pb-2\" },\n\t              \"This list goes on and on and will let them see each restaurant which is farther and farther away. They can now peruse the menus of each restaurant and pick one that serves what they feel like ordering. The problem is that they may spend some time scrolling and then leave the app without being able to make up their minds around which restaurant to place an order from. We have thrown too many choices at them and the cognitive effort of picking a restaurant and then a dish from the menu is too much work to make them suffer through.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              { className: \"lead\" },\n\t              _react2.default.createElement(\n\t                \"em\",\n\t                null,\n\t                \"But wait. Both Mila and Husain have transacted with us in the past, and we know a fair bit about their preferences.\"\n\t              )\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"To make this experience better, we decided to build a system that would let both of them see restaurants that suit their own tastes and preferences\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"h5\",\n\t              { className: \"text-center text-md-left text-black mt-5 maison-bold font-lg\" },\n\t              \"Applying Machine Learning to the Problem\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"Ranking documents for relevance works by assigning a prediction score to each document retrieved, which is directly proportional to its relevance. In the case of\",\n\t              \" \",\n\t              _react2.default.createElement(\n\t                \"kbd\",\n\t                { className: \"custom-code-block\" },\n\t                \"NEAR ME\"\n\t              ),\n\t              \" restaurant ranking this can be something like:\",\n\t              _react2.default.createElement(\n\t                \"blockquote\",\n\t                { \"class\": \"blockquote custom-blockquote my-4\" },\n\t                _react2.default.createElement(\n\t                  \"em\",\n\t                  { \"class\": \"mb-0 lead font-lg ml-3\" },\n\t                  \"Relevance score = 2 * (1/distance) + 1.2 * rating of restaurant\"\n\t                )\n\t              )\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"Here in the relevance score calculation, we are taking weighted sum of different factors like (1/distance) and rating of restaurant. The coefficients/weights of these factors can be arrived at by experimenting with them and choosing weights that seem to maximise the ordering conversions. But, in the case of restaurant ranking in GoFood, we want to take into consideration many factors when deciding relevance. Unfortunately, experimenting with combinations of all those factors is impossible.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"Enter Learning to rank. Here, the problem of deciding the rank of the restaurants shown to the user is formulated as a supervised machine learning problem.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"If we look at past search, click, and ordering data, we will be able to assign relevance judgements to each restaurant listing according to whether our users clicked or ordered from one of those restaurants. Restaurants that attracted higher degrees of interest will be given higher degrees of relevance.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"In the below example, a relevance judgement level of 0,1 and 2 is assigned to a restaurant according to whether the user viewed, clicked, or ordered from the restaurant in the search result. The relevance judgements are relative and only intent to be monotonically increasing with increasing relevance . They say that the restaurant which the user created an order from is more relevant than a restaurant the user merely checked out by clicking on it.\",\n\t              _react2.default.createElement(\n\t                \"span\",\n\t                { className: \"font-weight-bold\" },\n\t                \"They don\\u2019t mean that the restaurant which received the order is twice as relevant.\"\n\t              )\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              { className: \"pb-3\" },\n\t              \"The values of each of the factors that could have played a role in the user\\u2019s decision of clicking or ordering is also shown against the restaurants.\"\n\t            ),\n\t            _react2.default.createElement(\"img\", {\n\t              src: \"../images/blog/personalization.png\",\n\t              alt: \"Personalization\",\n\t              className: \"img-fluid img-responsive\"\n\t            }),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              { \"class\": \"text-center\" },\n\t              _react2.default.createElement(\n\t                \"small\",\n\t                { \"class\": \"text-muted\" },\n\t                \"An example of the training data user for creating the learning to rank model\"\n\t              )\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              { className: \"pt-3\" },\n\t              \"Three of the factors/features in the above example are marked as \\u2018personalisation features\\u2019 because they would change according to the user\\u2019s previous order history and location. These will be the features that will be different between Mila and Husain because of the differences in the restaurants and cuisines they have ordered from before in the past.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              { className: \"lead\" },\n\t              _react2.default.createElement(\n\t                \"em\",\n\t                null,\n\t                \"These personalisation features are at the crux of creating personalised experiences for each user\"\n\t              )\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"Other customer agnostic features/factors like the rating, price range, and popularity of the restaurant are also listed here. GoFood has millions of such examples where users with different tastes made different decisions when shown a set of search results. These examples can now be used to create a dataset from which the learning to rank ML algorithm can create a model to decide how relevant a GoFood user would find a restaurant given that user\\u2019s location, order history and other restaurant statistics.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"h5\",\n\t              { className: \"text-center text-md-left text-black mt-5 maison-bold font-lg\" },\n\t              \"How We Ranked\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"One way to approach this was as a point-wise ranking problem, wherein we try to predict the relevance judgement of each restaurant. Based on this, later we will predict the relevance judgement level and sort restaurants in decreasing order of predicted relevance score. This approach reduces learning to rank problem to a regression problem.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"Another approach was to solve it is a pairwise ranking problem, wherein the ML model is trying to learn how to get the order of a pair of restaurants correct i.e if Restaurant A is more preferable to Restaurant B , the order (Restaurant A, Restaurant B) is correct and the order (Restaurant B, Restaurant A) is wrong.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"For an ML model to be learned, we need an objective function that captures this pairwise ordering formulation . This is called a loss function or error function in ML and is the measure through which an ML model can assess how right or wrong its decision was. In pairwise ranking , this should be a function that becomes higher whenever the model misjudges a preference order and becomes lower when it is right about the preference order.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              { className: \"mb-0\" },\n\t              \"The loss/error function C is explained below:\"\n\t            ),\n\t            _react2.default.createElement(\"img\", {\n\t              src: \"../images/blog/algorithm.png\",\n\t              alt: \"Personalization\",\n\t              className: \"img-fluid img-responsive\"\n\t            }),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"When this function is minimised, the model is trying to predict a score for each restaurant such that the ranking of the order of the restaurants are close the relevance judgements the users made.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"The pairwise formulation is a better approach here in comparison to the point-wise approach as it is looking to get the order of restaurants right and is not trying to estimate the relevance score themselves whose values were assigned only as markers to show how some restaurants were more preferred relative to others.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"We used an implementation of the LambdaMART algorithm that learns to predict relevance scores so as to minimise this pairwise loss. You can think of this as a pursuit to find the decision tree that takes in all the parameters of the restaurant and gives out a score to the restaurant . This score should be assigned in such a way as to make the pair orders right.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"Once this model is trained, it can be used during search, as explained in\",\n\t              \" \",\n\t              _react2.default.createElement(\n\t                \"a\",\n\t                {\n\t                  target: \"_blank\",\n\t                  href: \"https://blog.gojekengineering.com/how-the-gojek-butler-serves-a-gourmet-meal-to-our-users-4a161d83052a\"\n\t                },\n\t                \"this\"\n\t              ),\n\t              \" \",\n\t              \"post.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"Now let\\u2019s go back to our beloved customers \\u2014 Mila and Husain. The next time Mila or Husain looks for restaurants near them, the search results they see will be according to their preferences. This is because the model would look at the number of times they have ordered from each of the restaurants near them before. It would take their preferred cuisines and factors like restaurant ratings into account, and show them the restaurants that they would prefer to order from first.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"The different search results Mila and Husain get after learning to rank is used to re-rank the results are shown below.\"\n\t            ),\n\t            _react2.default.createElement(\"img\", {\n\t              src: \"../images/blog/gojek-search-result.jpeg\",\n\t              alt: \"Gojek results\",\n\t              className: \"img-fluid img-responsive\"\n\t            }),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              { className: \"pt-4\" },\n\t              \"We ran an AB test using this formulation of learning to rank and observed a relative lift of 20% in search to ordering conversions and 23% improvement in NDCG. More information on how this metric is calculated here.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"h5\",\n\t              { className: \"text-center text-md-left text-black mt-5 maison-bold font-lg\" },\n\t              \"What We Learned\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              null,\n\t              \"One interesting thing we observed as we started experimenting with this learning to rank model was personalising search results led to the average position at which the search to order conversions happen to be much higher on the list. This is because users were increasingly seeing the restaurants that they have some affinity towards and were able to make an ordering decision without scrolling much and without spending too much time being confused where to order from.\"\n\t            ),\n\t            _react2.default.createElement(\n\t              \"p\",\n\t              { className: \"mb-5\" },\n\t              \"Checkout Data Science jobs -\",\n\t              \" \",\n\t              _react2.default.createElement(\n\t                \"a\",\n\t                { href: \"https://www.gojek.io/all-open-positions/?d=science&t=data-science\" },\n\t                \"Here\"\n\t              )\n\t            )\n\t          )\n\t        )\n\t      )\n\t    );\n\t  };\n\t\n\t  return GojekBlog;\n\t}(_react.Component);\n\t\n\texports.default = GojekBlog;\n\tmodule.exports = exports[\"default\"];\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// component---src-pages-the-secret-sauce-behind-search-personalisation-js-302506e4b3b72458952c.js","import React, { Component } from \"react\";\r\nimport { Helmet } from \"react-helmet\";\r\nimport SEO from \"../components/seo\";\r\n\r\nclass GojekBlog extends Component {\r\n  render() {\r\n    return (\r\n      <section className=\"first-section pt-3\">\r\n        <SEO\r\n          isDynamic={false}\r\n          title={` Gojek : The Secret Sauce Behind Search Personalisation `}\r\n          description={`How Gojek uses machine learning to personalise search results in GoFood.`}\r\n          url=\"https://gojek.io/the-secret-sauce-behind-search-personalisation\"\r\n        />\r\n\r\n        <div className=\"container\">\r\n          <div className=\"row\">\r\n            <div className=\"mb-3\">\r\n              <h2 className=\"mb-0 posting-headline mt-2 heading maison-bold font-lg text-black \">\r\n                The Secret Sauce Behind Search Personalisation\r\n              </h2>\r\n              <div className=\"text-success blog-date roboto-bold\">\r\n                <p>Written by - Jewel James</p>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"px-4 px-md-0 font-xs-l roboto-regular\">\r\n              <img\r\n                className=\"img-fluid img-responsive\"\r\n                src=\"../images/blog/search-personalisation-banner.jpeg\"\r\n                width=\"100%\"\r\n              />\r\n              <p className=\"pt-4\">\r\n                Are you looking for food? Thinking about burgers and crispy\r\n                chicken fritters with creamy sauces sitting on a warm, soft bun?\r\n                At least, that’s what I am thinking about. May be you’re\r\n                different. Vegan perhaps? Or craving noodles? Each of us turn\r\n                into a different person when we are hungry, and this is the\r\n                story about how GoFood — Gojek’s food delivery service — helps\r\n                you find the bite you crave.\r\n              </p>\r\n\r\n              <blockquote class=\"blockquote custom-blockquote my-4\">\r\n                <em class=\"mb-0 lead font-lg ml-3\">\r\n                  At the core of the food ordering experience, sits search.\r\n                </em>\r\n              </blockquote>\r\n\r\n              <p>\r\n                Searches are part of so many of our interactions on web and\r\n                mobile, that we don’t even notice it anymore. This is mostly\r\n                because modern search engines have matured to a point where they\r\n                can deliver high quality results even if the entered query is a\r\n                weak signal of the user’s intent. Even when weak, every query\r\n                still contains a piece of the user’s intent.\r\n              </p>\r\n\r\n              <p>\r\n                In the case of GoFood, that piece is a fragment of our user’s\r\n                hunger-driven brain.\r\n              </p>\r\n              <p>\r\n                In this post, we’ll discuss how we personalise the search\r\n                results we surface on GoFood, based on the information we have\r\n                about our users’ food preferences.\r\n              </p>\r\n\r\n              <h5 className=\"text-center text-md-left text-black mt-5 maison-bold font-lg\">\r\n                How Each of Us Differ\r\n              </h5>\r\n\r\n              <p className=\"mt-3 mb-5\">\r\n                Let’s look at two of our GoFood users who have started feeling\r\n                the pangs of hunger, and come online to check restaurants near\r\n                them. Let’s look at two of our GoFood users who have started\r\n                feeling the pangs of hunger, and come online to check\r\n                restaurants near them.\r\n              </p>\r\n\r\n              <img\r\n                src=\"../images/blog/comparision.jpeg\"\r\n                alt=\"How each of us differ\"\r\n                className=\"img-fluid img-responsive\"\r\n              />\r\n\r\n              <p className=\"pt-4\">\r\n                They both open our app and click on the{\" \"}\r\n                <kbd className=\"custom-code-block\">NEAR ME</kbd> tile that lets\r\n                users find the restaurants near them. We show them the nearest\r\n                restaurants first, and this is what they both see.\r\n              </p>\r\n              <img\r\n                src=\"../images/blog/near-me.jpeg\"\r\n                alt=\"Nearest restaurants\"\r\n                className=\"img-fluid img-responsive\"\r\n              />\r\n\r\n              <p className=\"pt-3 pb-2\">\r\n                This list goes on and on and will let them see each restaurant\r\n                which is farther and farther away. They can now peruse the menus\r\n                of each restaurant and pick one that serves what they feel like\r\n                ordering. The problem is that they may spend some time scrolling\r\n                and then leave the app without being able to make up their minds\r\n                around which restaurant to place an order from. We have thrown\r\n                too many choices at them and the cognitive effort of picking a\r\n                restaurant and then a dish from the menu is too much work to\r\n                make them suffer through.\r\n              </p>\r\n\r\n              <p className=\"lead\">\r\n                <em>\r\n                  But wait. Both Mila and Husain have transacted with us in the\r\n                  past, and we know a fair bit about their preferences.\r\n                </em>\r\n              </p>\r\n\r\n              <p>\r\n                To make this experience better, we decided to build a system\r\n                that would let both of them see restaurants that suit their own\r\n                tastes and preferences\r\n              </p>\r\n\r\n              <h5 className=\"text-center text-md-left text-black mt-5 maison-bold font-lg\">\r\n                Applying Machine Learning to the Problem\r\n              </h5>\r\n              <p>\r\n                Ranking documents for relevance works by assigning a prediction\r\n                score to each document retrieved, which is directly proportional\r\n                to its relevance. In the case of{\" \"}\r\n                <kbd className=\"custom-code-block\">NEAR ME</kbd> restaurant\r\n                ranking this can be something like:\r\n                <blockquote class=\"blockquote custom-blockquote my-4\">\r\n                  <em class=\"mb-0 lead font-lg ml-3\">\r\n                    Relevance score = 2 * (1/distance) + 1.2 * rating of\r\n                    restaurant\r\n                  </em>\r\n                </blockquote>\r\n              </p>\r\n              <p>\r\n                Here in the relevance score calculation, we are taking weighted\r\n                sum of different factors like (1/distance) and rating of\r\n                restaurant. The coefficients/weights of these factors can be\r\n                arrived at by experimenting with them and choosing weights that\r\n                seem to maximise the ordering conversions. But, in the case of\r\n                restaurant ranking in GoFood, we want to take into consideration\r\n                many factors when deciding relevance. Unfortunately,\r\n                experimenting with combinations of all those factors is\r\n                impossible.\r\n              </p>\r\n              <p>\r\n                Enter Learning to rank. Here, the problem of deciding the rank\r\n                of the restaurants shown to the user is formulated as a\r\n                supervised machine learning problem.\r\n              </p>\r\n              <p>\r\n                If we look at past search, click, and ordering data, we will be\r\n                able to assign relevance judgements to each restaurant listing\r\n                according to whether our users clicked or ordered from one of\r\n                those restaurants. Restaurants that attracted higher degrees of\r\n                interest will be given higher degrees of relevance.\r\n              </p>\r\n              <p>\r\n                In the below example, a relevance judgement level of 0,1 and 2\r\n                is assigned to a restaurant according to whether the user\r\n                viewed, clicked, or ordered from the restaurant in the search\r\n                result. The relevance judgements are relative and only intent to\r\n                be monotonically increasing with increasing relevance . They say\r\n                that the restaurant which the user created an order from is more\r\n                relevant than a restaurant the user merely checked out by\r\n                clicking on it.<span className=\"font-weight-bold\">\r\n                  They don’t mean that the restaurant which received the order\r\n                  is twice as relevant.\r\n                </span>\r\n              </p>\r\n              <p className=\"pb-3\">\r\n                The values of each of the factors that could have played a role\r\n                in the user’s decision of clicking or ordering is also shown\r\n                against the restaurants.\r\n              </p>\r\n\r\n              <img\r\n                src=\"../images/blog/personalization.png\"\r\n                alt=\"Personalization\"\r\n                className=\"img-fluid img-responsive\"\r\n              />\r\n              <p class=\"text-center\">\r\n                <small class=\"text-muted\">\r\n                  An example of the training data user for creating the learning\r\n                  to rank model\r\n                </small>\r\n              </p>\r\n\r\n              <p className=\"pt-3\">\r\n                Three of the factors/features in the above example are marked as\r\n                ‘personalisation features’ because they would change according\r\n                to the user’s previous order history and location. These will be\r\n                the features that will be different between Mila and Husain\r\n                because of the differences in the restaurants and cuisines they\r\n                have ordered from before in the past.\r\n              </p>\r\n              <p className=\"lead\">\r\n                <em>\r\n                  These personalisation features are at the crux of creating\r\n                  personalised experiences for each user\r\n                </em>\r\n              </p>\r\n\r\n              <p>\r\n                Other customer agnostic features/factors like the rating, price\r\n                range, and popularity of the restaurant are also listed here.\r\n                GoFood has millions of such examples where users with different\r\n                tastes made different decisions when shown a set of search\r\n                results. These examples can now be used to create a dataset from\r\n                which the learning to rank ML algorithm can create a model to\r\n                decide how relevant a GoFood user would find a restaurant given\r\n                that user’s location, order history and other restaurant\r\n                statistics.\r\n              </p>\r\n\r\n              <h5 className=\"text-center text-md-left text-black mt-5 maison-bold font-lg\">\r\n                How We Ranked\r\n              </h5>\r\n              <p>\r\n                One way to approach this was as a point-wise ranking problem,\r\n                wherein we try to predict the relevance judgement of each\r\n                restaurant. Based on this, later we will predict the relevance\r\n                judgement level and sort restaurants in decreasing order of\r\n                predicted relevance score. This approach reduces learning to\r\n                rank problem to a regression problem.\r\n              </p>\r\n              <p>\r\n                Another approach was to solve it is a pairwise ranking problem,\r\n                wherein the ML model is trying to learn how to get the order of\r\n                a pair of restaurants correct i.e if Restaurant A is more\r\n                preferable to Restaurant B , the order (Restaurant A, Restaurant\r\n                B) is correct and the order (Restaurant B, Restaurant A) is\r\n                wrong.\r\n              </p>\r\n\r\n              <p>\r\n                For an ML model to be learned, we need an objective function\r\n                that captures this pairwise ordering formulation . This is\r\n                called a loss function or error function in ML and is the\r\n                measure through which an ML model can assess how right or wrong\r\n                its decision was. In pairwise ranking , this should be a\r\n                function that becomes higher whenever the model misjudges a\r\n                preference order and becomes lower when it is right about the\r\n                preference order.\r\n              </p>\r\n              <p className=\"mb-0\">\r\n                The loss/error function C is explained below:\r\n              </p>\r\n              <img\r\n                src=\"../images/blog/algorithm.png\"\r\n                alt=\"Personalization\"\r\n                className=\"img-fluid img-responsive\"\r\n              />\r\n\r\n              <p>\r\n                When this function is minimised, the model is trying to predict\r\n                a score for each restaurant such that the ranking of the order\r\n                of the restaurants are close the relevance judgements the users\r\n                made.\r\n              </p>\r\n\r\n              <p>\r\n                The pairwise formulation is a better approach here in comparison\r\n                to the point-wise approach as it is looking to get the order of\r\n                restaurants right and is not trying to estimate the relevance\r\n                score themselves whose values were assigned only as markers to\r\n                show how some restaurants were more preferred relative to\r\n                others.\r\n              </p>\r\n              <p>\r\n                We used an implementation of the LambdaMART algorithm that\r\n                learns to predict relevance scores so as to minimise this\r\n                pairwise loss. You can think of this as a pursuit to find the\r\n                decision tree that takes in all the parameters of the restaurant\r\n                and gives out a score to the restaurant . This score should be\r\n                assigned in such a way as to make the pair orders right.\r\n              </p>\r\n              <p>\r\n                Once this model is trained, it can be used during search, as\r\n                explained in{\" \"}\r\n                <a\r\n                  target=\"_blank\"\r\n                  href=\"https://blog.gojekengineering.com/how-the-gojek-butler-serves-a-gourmet-meal-to-our-users-4a161d83052a\"\r\n                >\r\n                  this\r\n                </a>{\" \"}\r\n                post.\r\n              </p>\r\n\r\n              <p>\r\n                Now let’s go back to our beloved customers — Mila and Husain.\r\n                The next time Mila or Husain looks for restaurants near them,\r\n                the search results they see will be according to their\r\n                preferences. This is because the model would look at the number\r\n                of times they have ordered from each of the restaurants near\r\n                them before. It would take their preferred cuisines and factors\r\n                like restaurant ratings into account, and show them the\r\n                restaurants that they would prefer to order from first.\r\n              </p>\r\n              <p>\r\n                The different search results Mila and Husain get after learning\r\n                to rank is used to re-rank the results are shown below.\r\n              </p>\r\n\r\n              <img\r\n                src=\"../images/blog/gojek-search-result.jpeg\"\r\n                alt=\"Gojek results\"\r\n                className=\"img-fluid img-responsive\"\r\n              />\r\n              <p className=\"pt-4\">\r\n                We ran an AB test using this formulation of learning to rank and\r\n                observed a relative lift of 20% in search to ordering\r\n                conversions and 23% improvement in NDCG. More information on how\r\n                this metric is calculated here.\r\n              </p>\r\n              <h5 className=\"text-center text-md-left text-black mt-5 maison-bold font-lg\">\r\n                What We Learned\r\n              </h5>\r\n              <p>\r\n                One interesting thing we observed as we started experimenting\r\n                with this learning to rank model was personalising search\r\n                results led to the average position at which the search to order\r\n                conversions happen to be much higher on the list. This is\r\n                because users were increasingly seeing the restaurants that they\r\n                have some affinity towards and were able to make an ordering\r\n                decision without scrolling much and without spending too much\r\n                time being confused where to order from.\r\n              </p>\r\n              <p className=\"mb-5\">\r\n                Checkout Data Science jobs -{\" \"}\r\n                <a href=\"https://www.gojek.io/all-open-positions/?d=science&t=data-science\">\r\n                  Here\r\n                </a>\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    );\r\n  }\r\n}\r\n\r\nexport default GojekBlog;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/the-secret-sauce-behind-search-personalisation.js"],"sourceRoot":""}